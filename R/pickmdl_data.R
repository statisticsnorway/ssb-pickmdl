#' Function that returns an r object with data
#' 
#' @param dataset Name of data set within the pickmdl package
#'
#' @return An r object with data 
#' 
#' @details 
#' \strong{myseries:} A univariate time series made from `pickmdl_data("datainn")`
#' 
#' \strong{allvar:} Matrix of time series (mts) made from `pickmdl_data("kalendernr3")` 
#' 
#' \strong{datainn:} A vector of data.
#' 
#' \strong{kalendernr3:} As `read.table("kalendernr3.txt")`
#' 
#' \strong{myseries_old:} Old version of `myseries`, directly from `datainn`.  
#' 
#' @export
#' @importFrom utils data
#' @importFrom stats ts ts.union rnorm runif
#'
#' @examples
#' pickmdl_data("myseries")
#' pickmdl_data("qseries")
#' pickmdl_data("allvar")
#' pickmdl_data("datainn")
#' pickmdl_data("kalendernr3")
pickmdl_data <- function(dataset){
  
  forstear <- 2005
  sistear  <- 2021
  sistemn  <- 9
  
  if (dataset == "myseries") {
    myseries_old <- pickmdl_data("myseries_old")
    return(myseries_old + round(4 * rnorm_seed(length(myseries_old)), 1))
  }
  
  if(dataset == "myseries_old"){
    datainn <- pickmdl_data("datainn")
    myseries <- ts(datainn, start = c(forstear, 1), frequency = 12)
    return(myseries)
  }
  
  if(dataset == "qseries"){
    datainn <- pickmdl_data("datainn")
    qseries <- ts(datainn[2 + (0:66) * 3], start = c(forstear, 1), frequency = 4)
    return(qseries)
  }
  
  if(dataset == "allvar"){
    kalkorr  <- pickmdl_data("kalendernr3") # read.table("kalendernr3.txt")
    arb_dag0 <- as.numeric(kalkorr[, 2]) 
    arb_dag  <- ts(arb_dag0, start = c(forstear, 1), frequency = 12)
    skuddar0 <- kalkorr[, 3]
    skuddar  <- ts(skuddar0, start = c(forstear, 1), frequency = 12)
    allvar   <- ts.union(arb_dag, skuddar)
    return(allvar)
  }
    
  
  if(dataset == "datainn")
    return( c(
    80.7,  69.1,  70.4,  79.7,  72.9,  85.0,  43.7,  83.2,  91.5,  81.1,  89.2,  75.0,  
    88.9,  72.7,  86.2,  69.6,  84.3,  88.8,  46.5,  88.7,  93.1,  91.2,  95.5,  71.6,
    96.5,  78.9,  89.2,  77.3,  88.1,  92.7,  54.3,  94.4,  94.4, 100.3, 100.3,  70.6,  
    99.4,  85.8,  73.7,  95.6,  87.9,  92.5,  58.4,  84.1, 102.8, 100.4,  91.3,  79.9,
    87.6,  75.1,  84.8,  75.5,  76.9,  85.5,  53.8,  77.5,  94.7,  86.1,  86.1,  75.9,  
    79.2,  71.3,  84.4,  77.0,  74.1,  91.6,  49.7,  82.2,  95.2,  82.8,  91.1,  80.8,
    85.3,  73.1,  86.7,  72.9,  87.4,  83.0,  46.1,  87.9,  96.7,  89.3,  98.2,  82.6,  
    96.7,  83.6,  89.4,  79.4,  90.5,  95.3,  55.4,  96.3,  96.3, 103.6, 103.6,  73.0,
    103.6,  84.8,  81.6,  99.9,  91.4,  96.5,  63.9,  97.2, 107.4, 112.6, 107.5,  84.4, 
    108.6,  88.8,  95.4,  93.7, 100.8, 100.8,  67.4,  97.1, 118.7, 115.1, 104.7,  91.6,
    104.5,  89.6, 101.2,  95.4,  91.8, 113.4,  68.1,  98.0, 119.8, 110.5, 110.5,  97.3,  
    98.9,  97.7,  94.5, 105.0,  97.9, 115.0,  65.9, 108.4, 122.8, 113.1, 123.9, 107.0,
    113.0,  98.6, 118.6,  86.7, 106.6, 115.8,  66.4, 114.9, 124.3, 124.4, 130.9, 102.0, 
    118.5, 103.4, 103.6, 109.6, 106.9, 120.6,  74.6, 120.0, 124.3, 134.8, 136.7, 100.9,
    124.6, 109.3, 120.3, 106.3, 117.2, 114.7,  83.7, 119.3, 134.1, 139.0, 134.4, 107.9, 
    124.9, 107.3, 125.0, 102.2, 110.8, 121.9,  80.8, 109.5, 136.5, 130.5, 132.1, 117.5,
    115.6, 108.8, 125.6, 108.2, 104.0, 128.8,  73.5, 115.6, 138.3))
  
  if(dataset == "kalendernr3")   # generated by dput(read.table("kalendernr3.txt"))
    return(structure(list(V1 = c("2005-01-01", "2005-02-01", "2005-03-01", 
                                 "2005-04-01", "2005-05-01", "2005-06-01", "2005-07-01", "2005-08-01", 
                                 "2005-09-01", "2005-10-01", "2005-11-01", "2005-12-01", "2006-01-01", 
                                 "2006-02-01", "2006-03-01", "2006-04-01", "2006-05-01", "2006-06-01", 
                                 "2006-07-01", "2006-08-01", "2006-09-01", "2006-10-01", "2006-11-01", 
                                 "2006-12-01", "2007-01-01", "2007-02-01", "2007-03-01", "2007-04-01", 
                                 "2007-05-01", "2007-06-01", "2007-07-01", "2007-08-01", "2007-09-01", 
                                 "2007-10-01", "2007-11-01", "2007-12-01", "2008-01-01", "2008-02-01", 
                                 "2008-03-01", "2008-04-01", "2008-05-01", "2008-06-01", "2008-07-01", 
                                 "2008-08-01", "2008-09-01", "2008-10-01", "2008-11-01", "2008-12-01", 
                                 "2009-01-01", "2009-02-01", "2009-03-01", "2009-04-01", "2009-05-01", 
                                 "2009-06-01", "2009-07-01", "2009-08-01", "2009-09-01", "2009-10-01", 
                                 "2009-11-01", "2009-12-01", "2010-01-01", "2010-02-01", "2010-03-01", 
                                 "2010-04-01", "2010-05-01", "2010-06-01", "2010-07-01", "2010-08-01", 
                                 "2010-09-01", "2010-10-01", "2010-11-01", "2010-12-01", "2011-01-01", 
                                 "2011-02-01", "2011-03-01", "2011-04-01", "2011-05-01", "2011-06-01", 
                                 "2011-07-01", "2011-08-01", "2011-09-01", "2011-10-01", "2011-11-01", 
                                 "2011-12-01", "2012-01-01", "2012-02-01", "2012-03-01", "2012-04-01", 
                                 "2012-05-01", "2012-06-01", "2012-07-01", "2012-08-01", "2012-09-01", 
                                 "2012-10-01", "2012-11-01", "2012-12-01", "2013-01-01", "2013-02-01", 
                                 "2013-03-01", "2013-04-01", "2013-05-01", "2013-06-01", "2013-07-01", 
                                 "2013-08-01", "2013-09-01", "2013-10-01", "2013-11-01", "2013-12-01", 
                                 "2014-01-01", "2014-02-01", "2014-03-01", "2014-04-01", "2014-05-01", 
                                 "2014-06-01", "2014-07-01", "2014-08-01", "2014-09-01", "2014-10-01", 
                                 "2014-11-01", "2014-12-01", "2015-01-01", "2015-02-01", "2015-03-01", 
                                 "2015-04-01", "2015-05-01", "2015-06-01", "2015-07-01", "2015-08-01", 
                                 "2015-09-01", "2015-10-01", "2015-11-01", "2015-12-01", "2016-01-01", 
                                 "2016-02-01", "2016-03-01", "2016-04-01", "2016-05-01", "2016-06-01", 
                                 "2016-07-01", "2016-08-01", "2016-09-01", "2016-10-01", "2016-11-01", 
                                 "2016-12-01", "2017-01-01", "2017-02-01", "2017-03-01", "2017-04-01", 
                                 "2017-05-01", "2017-06-01", "2017-07-01", "2017-08-01", "2017-09-01", 
                                 "2017-10-01", "2017-11-01", "2017-12-01", "2018-01-01", "2018-02-01", 
                                 "2018-03-01", "2018-04-01", "2018-05-01", "2018-06-01", "2018-07-01", 
                                 "2018-08-01", "2018-09-01", "2018-10-01", "2018-11-01", "2018-12-01", 
                                 "2019-01-01", "2019-02-01", "2019-03-01", "2019-04-01", "2019-05-01", 
                                 "2019-06-01", "2019-07-01", "2019-08-01", "2019-09-01", "2019-10-01", 
                                 "2019-11-01", "2019-12-01", "2020-01-01", "2020-02-01", "2020-03-01", 
                                 "2020-04-01", "2020-05-01", "2020-06-01", "2020-07-01", "2020-08-01", 
                                 "2020-09-01", "2020-10-01", "2020-11-01", "2020-12-01", "2021-01-01", 
                                 "2021-02-01", "2021-03-01", "2021-04-01", "2021-05-01", "2021-06-01", 
                                 "2021-07-01", "2021-08-01", "2021-09-01", "2021-10-01", "2021-11-01", 
                                 "2021-12-01", "2022-01-01", "2022-02-01", "2022-03-01", "2022-04-01", 
                                 "2022-05-01", "2022-06-01", "2022-07-01", "2022-08-01", "2022-09-01", 
                                 "2022-10-01", "2022-11-01", "2022-12-01"), 
                          V2 = c(-1.5, 0, -6.733, 
                                 8.25, -0.512, 3.495, -4, 3, 2, -4, 2, 3.5, 2, 0, 7.267, -9.25, 
                                 2.988, -0.005, -4, 3, -1.5, -0.5, 2, -3.5, 2, 0, 3.767, -5.75, 
                                 2.988, -0.005, -0.5, 3, -5, 3, 2, -7, 2, 1, -13.733, 11.75, 2.988, 
                                 -0.005, 3, -4, 2, 3, -5, 0, -1.5, 0, 3.767, -2.25, -0.512, -0.005, 
                                 3, -4, 2, -0.5, -1.5, 3.5, -5, 0, 3.767, 1.25, -4.012, 3.495, 
                                 -0.5, -0.5, 2, -4, 2, 7, -1.5, 0, 7.267, -5.75, 6.488, -3.505, 
                                 -4, 3, 2, -4, 2, 3.5, 2, 1, 3.767, -5.75, 2.988, -0.005, -0.5, 
                                 3, -5, 3, 2, -7, 2, 0, -10.233, 8.25, -0.512, -3.505, 3, -0.5, 
                                 -1.5, 3, -1.5, -3.5, 2, 0, 0.267, -2.25, 2.988, -3.505, 3, -4, 
                                 2, 3, -5, 0, -1.5, 0, 3.767, -2.25, -4.012, 3.495, 3, -4, 2, 
                                 -0.5, -1.5, 3.5, -5, 1, -6.733, 8.25, -0.512, 3.495, -4, 3, 2, 
                                 -4, 2, 3.5, 2, 0, 7.267, -9.25, 2.988, -0.005, -4, 3, -1.5, -0.5, 
                                 2, -3.5, 2, 0, -6.733, 4.75, -0.512, -0.005, -0.5, 3, -5, 3, 
                                 2, -7, 2, 0, 0.267, -2.25, 2.988, -7.005, 3, -0.5, -1.5, 3, -1.5, 
                                 -3.5, 2, -2.5, 3.767, -2.25, -0.512, -0.005, 3, -4, 2, -0.5, 
                                 -1.5, 3.5, -5, 0, 3.767, 1.25, -4.012, 3.495, -0.5, -0.5, 2, 
                                 -4, 2, 7, -1.5, 0, 7.267, -5.75, 2.988, -0.005, -4, 3, 2, -4, 
                                 2, 3.5), 
                          V3 = c(0, -0.25, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, -0.25, 
                                 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, -0.25, 0, 0, 0, 0, 0, 0, 0, 
                                 0, 0, 0, 0, 0.75, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, -0.25, 0, 
                                 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, -0.25, 0, 0, 0, 0, 0, 0, 0, 0, 
                                 0, 0, 0, -0.25, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.75, 0, 0, 
                                 0, 0, 0, 0, 0, 0, 0, 0, 0, -0.25, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
                                 0, 0, -0.25, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, -0.25, 0, 0, 0, 
                                 0, 0, 0, 0, 0, 0, 0, 0, 0.75, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
                                 -0.25, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, -0.25, 0, 0, 0, 0, 0, 
                                 0, 0, 0, 0, 0, 0, -0.25, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.75, 
                                 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, -0.25, 0, 0, 0, 0, 0, 0, 0, 
                                 0, 0, 0, 0, -0.25, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0)), 
                     class = "data.frame", row.names = c(NA, -216L)))
  stop(paste("No data with dataset =", dataset))
}


# rnorm with fixed seed without affecting users random value stream
# Code inside the if-block is similar to other SSB packages 
rnorm_seed <- function(x, fun = rnorm, rndseed = 123, ...){
  if (!is.null(rndseed)) {
    if (!exists(".Random.seed")) 
      if (runif(1) < 0) 
        stop("Now seed exists")
    exitSeed <- .Random.seed
    on.exit(.Random.seed <<- exitSeed)
    set.seed(rndseed)
  }
  fun(x, ...)
}


